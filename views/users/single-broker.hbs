<div class="page-title page-title-fixed" style="opacity: 1;">
    <h1>{{broker.bname}}</h1>
    <a href="/all-brokers" class="page-title-icon shadow-xl bg-theme color-theme" data-menu="menu-share"><i
            class="fas fa-chevron-left"></i></a>
    <a href="#" class="page-title-icon shadow-xl bg-theme color-theme show-on-theme-dark" data-toggle-theme=""><i
            class="fa fa-lightbulb color-yellow-dark"></i></a>
    <a href="#" class="page-title-icon shadow-xl bg-theme color-theme" data-menu="menu-main"><i
            class="fa fa-bars"></i></a>
</div>

<div class="page-content">
    <br><br><br><br>

    <div class="card card-full-center bg-dark text-white card-style mt-5">
        <div class="content">
            <div class="d-flex">
                <div class="me-3">
                    <img width="120" height="auto" class="fluid-img rounded-m shadow-xl bg-white"
                        src="../images/broker-images/{{broker._id}}.png">
                </div>
                <div>
                    {{!-- <p class="mb-1"><b>Broker Id : </b>{{broker._id}}</p> --}}
                    <h2 class="mb-2 text-white">{{broker.bname}}</h2><br>
                    <p class="text-white" style="margin-top: -30px;"><b>Broker Id : </b>#{{broker.bid}}</p>
                    <p class="text-white" style="margin-top: -30px;"><b>Created By :</b>{{broker.uname}} </p>
                    <p class="text-white" style="margin-top: -30px;"><b>Created at :</b> {{broker.date}} </p>
                </div>
            </div>
        </div>
    </div>


    <div class="card card-full-center  card-style" style="margin-top: -20px;">
        <div class="content">
            <div class="d-flex">
                <div>
                    <h4 class="mb-2">Broker Status</h4>
                    <!-- Add this section in your single-broker.hbs file -->
                    {{#if successMessage}}
                    <div class="text-success">
                        {{broker.uname}} Credentials uploaded successfully!
                    </div>
                    {{/if}}

                    <!-- Your existing code to display broker details and credentials -->
                    <!-- ... -->

                    {{!-- {{console.log(credentials)}} --}}
                    {{#each credentials}}
                    {{#if this.status}}
                    <p>{{this.status}}</p>
                    {{else}}
                    <p>Broker is ready to accept your resources</p>
                    {{/if}}
                    {{/each}}
                </div>


            </div>
        </div>
    </div>

    <style>
        .visible {
            filter: blur(5px);
            /* Initial blur effect */
        }

        .visible.visible2 {
            filter: none;
            /* Remove blur effect when visible class is applied */
        }
    </style>

    <div class="card card-full-center  card-style" style="margin-top: -20px;">
        <div class="content">
            <div class="d-flex">
                <div>
                    <h4 class="mb-2">Transfered Data</h4>
                    <hr>
                    <!-- Add this section in your single-broker.hbs file -->
                    {{#if transferStatus}}
                    <div class="text-dark">
                        {{#eq transferdata.against "Payment"}}
                        <div class="visible">
                            <h6>Username : <b class="text-success" id="username">{{transferdata.username}}</b></h6>
                            <h6>Password : <b class="text-success" id="password">{{transferdata.password}}</b></h6>
                            <h6>Access Key : <b class="text-success" id="access">{{transferdata.access}}</b></h6>
                        </div>
                        <button class="btn btn-sm mt-3 btn-dark" style="border-radius: 10px;"
                            onclick="copyContent()"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                                fill="currentColor" class="bi bi-copy" viewBox="0 0 16 16">
                                <path fill-rule="evenodd"
                                    d="M4 2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2zm2-1a1 1 0 0 0-1 1v8a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1zM2 5a1 1 0 0 0-1 1v8a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1v-1h1v1a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h1v1z" />
                            </svg></button>

                        <button class="btn btn-sm mt-3 btn-primary" style="border-radius: 10px;"
                            onclick="reloadPage()"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                                fill="currentColor" class="bi bi-arrow-clockwise" viewBox="0 0 16 16">
                                <path fill-rule="evenodd"
                                    d="M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2z" />
                                <path
                                    d="M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466" />
                            </svg></button>

                        <button class="btn btn-sm mt-3 btn-danger" style="border-radius: 10px;"
                            onclick="toggleVisibility()"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                                fill="currentColor" class="bi bi-eye" viewBox="0 0 16 16">
                                <path
                                    d="M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8M1.173 8a13 13 0 0 1 1.66-2.043C4.12 4.668 5.88 3.5 8 3.5s3.879 1.168 5.168 2.457A13 13 0 0 1 14.828 8q-.086.13-.195.288c-.335.48-.83 1.12-1.465 1.755C11.879 11.332 10.119 12.5 8 12.5s-3.879-1.168-5.168-2.457A13 13 0 0 1 1.172 8z" />
                                <path
                                    d="M8 5.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5M4.5 8a3.5 3.5 0 1 1 7 0 3.5 3.5 0 0 1-7 0" />
                            </svg></button>




                        {{/eq}}
                        {{#eq transferdata.against "Credentials"}}
                        <h6 class="text-success">{{transferdata.amount}} Paid Successfully</h6>
                        {{/eq}}
                        <button class="btn btn-sm mt-3 btn-primary" style="border-radius: 10px;"
                            onclick="reloadPage()"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                                fill="currentColor" class="bi bi-arrow-clockwise" viewBox="0 0 16 16">
                                <path fill-rule="evenodd"
                                    d="M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2z" />
                                <path
                                    d="M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466" />
                            </svg></button>
                    </div>
                    {{/if}}

                    <!-- Your existing code to display broker details and credentials -->
                    <!-- ... -->

                    {{!-- {{console.log(credentials)}} --}}
                    {{#each credentials}}
                    {{#if this.status}}
                    <p>{{this.status}}</p>
                    {{else}}
                    <p>Broker is ready to accept your resources</p>
                    {{/if}}
                    {{/each}}
                </div>


            </div>
        </div>
    </div>




    <div class="card card-full-center card-style" style="margin-top: -20px;">
        <div class="content">
            <div class="d-flex">
                <div>
                    <div class="d-flex">
                        <div class="w-35 border-right pe-3 border-highlight">
                            <img src="../../assets/images/avatars/2s.png" width="80"
                                class="bg-highlight rounded-circle">
                            <h6 class="font-14 font-600 mt-2 text-center">{{broker.uname}}</h6>
                            <p class="color-blue-dark mt-n3 font-9 font-400 text-center mb-0 pt-1">Broker Owner</p>
                        </div>
                        <div class="w-65 ps-3 pt-2">
                            <h5 class="mb-2">Other Users</h5>
                            <a href="#"><img src="../../assets/images/avatars/1s.png" data-src="images/avatars/1s.png"
                                    width="40" class="rounded-circle preload-img entered loaded"
                                    data-ll-status="loaded"></a>
                            {{!-- <a class="float-end" href="#"
                                onclick="return confirm('Are You Sure to Remove {{broker.pairedUser}} ?')"><i
                                    class="fa fa-trash text-danger"></i></a> --}}
                            <h6 class="font-14 font-600 mt-2">{{broker.pairedUser}}</h6>




                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div><br>




    <div class="container mt-2">
        <a href="#" data-menu="menu-resources"
            class="btn btn-m btn-full mb-2 rounded-xs text-uppercase font-700 shadow-s bg-orange-light">Start
            Dealing</a>
        <a href="/chat/?pu_id={{broker.pu_id}}&user_id={{broker.userId}}&brokerId={{broker._id}}"
            class="btn btn-m btn-full mb-2 rounded-xs text-uppercase font-700 shadow-s bg-dark">Start
            Chatting</a>
        <center>
            <a href="#" data-menu="menu-report" class="text-center mt-4">Report a complaint</a>
        </center>


    </div>


</div>

<br><br><br><br><br><br><br><br>



<div id="menu-resources" class="menu menu-box-bottom rounded-m" data-menu-height="230" data-menu-effect="menu-over">
    <div class="menu-title">
        <h4 class="text-center mt-4 mb-4">Select Your Resource Type</h4>
        <a href="#" class="close-menu"><i class="fa fa-times-circle"></i></a>
    </div>
    <div class="content">
        <a href="#" data-menu="menu-Credentials"
            class="btn btn-l font-14 shadow-l btn-full rounded-s font-600 bg-green-dark text-start mb-2"><span
                class="ms-n2">Credentials</span><span class="float-end me-n1"></span></a>
        {{!-- <a href="tel:+2 234 567 890"
            class="btn btn-l font-14 shadow-l btn-full rounded-s font-600 bg-blue-dark text-start mb-2"><span
                class="ms-n2">Documents</span><span class="float-end me-n1"></span></a> --}}
        <a href="#" data-menu="menu-Payment"
            class="btn btn-l font-14 shadow-l btn-full rounded-s font-600 bg-red-dark text-start"><span
                class="ms-n2">Payment</span><span class="float-end me-n1"></span></a>
        {{!-- <a href="tel:+3 234 567 890"
            class="btn btn-l font-14 mt-2 shadow-l btn-full rounded-s font-600 bg-dark text-start"><span
                class="ms-n2">Images</span><span class="float-end me-n1"></span></a> --}}

    </div>
</div>
<!-------------------REPORTS------------------------->
<div id="menu-report" class="menu menu-box-bottom rounded-m" data-menu-height="410" data-menu-effect="menu-over">
    <div class="menu-title">
        <h4 class="font-16 text-center mt-4 mb-4">Report a complaint</h4>
        <a href="#" class="close-menu"><i class="fa fa-times-circle"></i></a>
    </div>
    <div class="content mb-0 mt-0">
        <div class="card p-4" style="border-radius: 20px;">
            <form action="/add-report" method="post" enctype="multipart/form-data">
                <input type="hidden" name="date" id="datetime">
                <input value="" id="b_id" name="brokerId" hidden>
                <input type="hidden" name="bid" id="hello">
                <input type="hidden" name="uname" value="{{#if user}}{{user.Name}}{{/if}}">
                <input type="hidden" id="user_id" value="{{#if user}}{{user._id}}{{/if}}" name="userId">
                <input type="hidden" value="raised" name="status">



                <div class="input-style has-borders has-icon validate-field mb-4">
                    <i class="fa fa-user"></i>
                    <input type="text" name="sub" class="form-control validate-name" id="form1acd" placeholder="Subject"
                        required>
                    <label for="form1acd" class="color-highlight font-11 font-500">Subject</label>
                    <i class="fa fa-times disabled invalid color-red-dark"></i>
                    <i class="fa fa-check disabled valid color-green-dark"></i>
                    <em>(required)</em>
                </div>

                <div class="input-style has-borders no-icon mb-4">
                    <textarea id="form7" name="msg" placeholder="Enter your message" required></textarea>
                    <label for="form7" class="color-highlight">Enter Your Message</label>
                    <em class="mt-n3">(required)</em>
                </div>
                <div class="input-style has-borders  validate-field mb-4">
                    <input type="file" name="Image" class="form-control validate-name" id="form1acd"
                        placeholder="Subject">
                    <label for="form1acd" class="color-highlight font-11 font-500">Subject</label>
                    <em>(optional)</em>
                </div>
                <button type="submit"
                    class="btn btn-full btn-m shadow-l mb-3 w-100 rounded-s font-600 bg-blue-dark mt-4">
                    Submit</button>
            </form>
        </div>
    </div>
</div>


<!-------------------Credentials------------------------->
<div id="menu-Credentials" class="menu menu-box-bottom rounded-m" data-menu-height="550" data-menu-effect="menu-over">
    <div class="menu-title">
        <h4 class="font-16 text-center mt-4 mb-4">Enter Your Credentials</h4>
        <a href="#" class="close-menu"><i class="fa fa-times-circle"></i></a>
    </div>
    <div class="content mb-0 mt-0">
        <div class="card p-4" style="border-radius: 20px;">
            <form action="/add-credential" method="post" enctype="multipart/form-data">
                <input type="hidden" name="date" id="datetime">
                <input type="hidden" name="category" value="Credentials">
                <input type="hidden" name="uname" value="{{#if user}}{{user.Name}}{{/if}}">
                <input type="hidden" name="status" value="{{#if user}}{{user.Name}}{{/if}} uploaded sucessfully">
                <input type="hidden" id="user_id" value="{{#if user}}{{user._id}}{{/if}}" name="userId">
                <input type="hidden" id="b_id" value="{{#if broker}}{{broker._id}}{{/if}}" name="brokerId">

                <div class="input-style has-borders no-icon mb-4">
                    <label for="form5" class="color-highlight">Type</label>
                    <select id="form5" name="type" onchange="handleSelectChange(this)">
                        <option value="default" disabled="" selected="">Select</option>
                        <option value="Instagram">Instagram</option>
                        <option value="Facebook">Facebook</option>
                        <option value="Twitter">Twitter</option>
                        <option value="Pubg">Pubg</option>
                        <option value="Freefire">Freefire</option>
                        <option value="other">Other</option>
                    </select>
                    <span><i class="fa fa-chevron-down"></i></span>
                    <em></em>

                    <!-- Hidden input field for "Other" option -->
                    <div id="otherInput" class="mt-3" style="display: none;">
                        <label for="otherValue" class="color-highlight">Other Category</label>
                        <input name="type" type="text" id="otherValue" placeholder="Enter the name" required>
                    </div>
                </div>

                <div class="input-style has-borders has-icon validate-field mb-4">
                    <i class="fa fa-user"></i>
                    <input type="name" name="username" class="form-control validate-name" id="form1acd"
                        placeholder="Username / Email / ID" required>
                    <label for="form1acd" class="color-highlight font-11 font-500">Username / Email / ID</label>
                    <i class="fa fa-times disabled invalid color-red-dark"></i>
                    <i class="fa fa-check disabled valid color-green-dark"></i>
                    <em>(required)</em>
                </div>

                <div class="input-style has-borders has-icon validate-field mb-4">
                    <i class="fa fa-key"></i>
                    <input type="name" name="password" class="form-control validate-name" id="form1acd"
                        placeholder="Password" required>
                    <label for="form1acd" class="color-highlight font-11 font-500">Password</label>
                    <i class="fa fa-times disabled invalid color-red-dark"></i>
                    <i class="fa fa-check disabled valid color-green-dark"></i>
                    <em>(required)</em>
                </div>

                <div class="input-style has-borders has-icon validate-field mb-4">
                    <i class="fa fa-key"></i>
                    <input type="name" name="access" class="form-control validate-name" id="form1acd"
                        placeholder="Access Key">
                    <label for="form1acd" class="color-highlight font-11 font-500">Access Key</label>
                    <i class="fa fa-times disabled invalid color-red-dark"></i>
                    <i class="fa fa-check disabled valid color-green-dark"></i>
                    <em>(optional)</em>
                </div>
                <button type="submit"
                    class="btn btn-full btn-m shadow-l mb-3 w-100 rounded-s font-600 bg-blue-dark mt-4">
                    Upload to broker</button>
            </form>
        </div>
    </div>
</div>

<!-------------------Payment------------------------->
<div id="menu-Payment" class="menu menu-box-bottom rounded-m" data-menu-height="550" data-menu-effect="menu-over">
    <div class="menu-title">
        <h4 class="font-16 text-center mt-4 mb-4">Enter Your Payment</h4>
        <a href="#" class="close-menu"><i class="fa fa-times-circle"></i></a>
    </div>
    <div class="content mb-0 mt-0">
        <div class="card p-4" style="border-radius: 20px;">
            <form action="/add-payment" id="checkout-form" method="post" enctype="multipart/form-data">
                <input type="hidden" name="date" id="date">
                <input type="hidden" id="category" name="category" value="Payment">
                <input type="hidden" id="uname" name="uname" value="{{#if user}}{{user.Name}}{{/if}}">
                <input type="hidden" id="status" name="status"
                    value="{{#if user}}{{user.Name}}{{/if}} payment  uploaded sucessfully">
                <input type="hidden" id="user_id1" id="user_id" value="{{#if user}}{{user._id}}{{/if}}" name="userId">
                <input type="hidden" id="b_id1" value="{{#if broker}}{{broker._id}}{{/if}}" name="brokerId">

                <div class="input-style has-borders no-icon mb-4">
                    <label for="form5" class="color-highlight">Payment for</label>
                    <select id="type" name="type" onchange="handleSelectChange(this)">
                        <option value="default" disabled="" selected="">Select</option>
                        <option value="Credentials">Credentials</option>
                        <option value="Documents">Documents</option>
                        <option value="Images">Images</option>
                    </select>
                    <span><i class="fa fa-chevron-down"></i></span>
                    <em>(required)</em>

                </div>

                <div class="input-style has-borders has-icon validate-field mb-4">
                    <i class="fa fa-user"></i>
                    <input type="number" id="amount" name="amount" class="form-control validate-name" id="form1acd"
                        placeholder="Type your amount" required>
                    <label for="form1acd" class="color-highlight font-11 font-500">Type your amount</label>
                    <i class="fa fa-times disabled invalid color-red-dark"></i>
                    <i class="fa fa-check disabled valid color-green-dark"></i>
                    <em>(required)</em>
                </div>
                <input id="pay" class="btn btn-success" type="button" name="" value="Pay Now">
                <button type="submit"
                    class="btn btn-full btn-m shadow-l mb-3 w-100 rounded-s font-600 bg-blue-dark mt-4">
                    Pays to broker</button>
            </form>
        </div>
    </div>
</div>


<script>
    const hiddenTextBox = document.getElementById('b_id');

    // Set the value of the hidden text box
    hiddenTextBox.value = window.location.href.split('/').pop();
    console.log(hiddenTextBox.value)
</script>

<script>
    function handleSelectChange(selectElement) {
        var otherInput = document.getElementById('otherInput');
        var otherValueInput = document.getElementById('otherValue');

        if (selectElement.value === 'other') {
            otherInput.style.display = 'block';
            otherValueInput.required = true; // Make the input field required if "Other" is selected
        } else {
            otherInput.style.display = 'none';
            otherValueInput.required = false; // Make the input field not required if "Other" is not selected
        }
    }
</script>

<script>
    // Get current date and time
    const now = new Date();
    const year = now.getFullYear();
    const month = (now.getMonth() + 1).toString().padStart(2, '0');
    const day = now.getDate().toString().padStart(2, '0');
    const hours = ((now.getHours() + 11) % 12 + 1).toString().padStart(2, '0'); // Convert to 12-hour format
    const minutes = now.getMinutes().toString().padStart(2, '0');
    const ampm = now.getHours() >= 12 ? 'PM' : 'AM';

    // Set default value to current date and time in MM/DD/YYYY format
    const defaultDateTime = `${month}/${day}/${year}T${hours}:${minutes}`;
    document.getElementById('datetime').value = defaultDateTime;
</script>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        generateRandomNumericCode();
    });

    function generateRandomNumericCode() {
        // Generate a random 5-digit numeric code
        const randomCode = Math.floor(10000 + Math.random() * 90000);

        // Set the value of the input field
        document.getElementById('hello').value = randomCode;

        // Log the generated code to the console (optional)
        console.log('Generated Code:', randomCode);
    }
</script>


<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="https://checkout.razorpay.com/v1/checkout.js"></script>

<script>
    $('#pay').on('click', function () {

        var formData = {
            category: document.querySelector('#category').value,
            uname: document.querySelector("#uname").value,
            status: document.querySelector("#status").value,
            user_id: document.querySelector("#user_id").value,
            b_id: document.querySelector("#b_id").value,
            type: document.querySelector("#type").value,
            amount: document.querySelector("#amount").value,
        };
        var donationAmount = formData.amount;
        const timestamp = new Date().getTime();
        const random = Math.floor(Math.random() * 10000);
        const orderId = `${timestamp}${random}`;
        const amount = donationAmount * 100;
        if (donationAmount && donationAmount > 0) {
            razorpayPayment(orderId, amount)
            $('#submit').prop('disabled', false);
        } else {
            alert('Please enter a valid donation amount.');
        }

    });


    /* $("#checkout-form").submit((e) => {
         e.preventDefault();
           $.ajax({
                  $.ajax({
             url: '/donateUs',
             method: 'post',
             data: $("#checkout-form").serialize(),
             success: (response) => {
      
             }
         })
         
        
     }) */

    function razorpayPayment(order, amount) {
        var options = {
            "key": "rzp_test_8NokNgt8cA3Hdv", // Enter the Key ID generated from the Dashboard
            "amount": amount, // Amount is in currency subunits. Default currency is INR. Hence, 50000 refers to 50000 paise
            "currency": "INR",
            "name": "Shopping Cart",
            "description": "Test Transaction",
            "image": "https://example.com/your_logo",
            "order_id": order.id, //This is a sample Order ID. Pass the `id` obtained in the response of Step 1
            "handler": function (response) {
                verifyPayment(response, order)
            },
            "prefill": {
                "name": "Gaurav Kumar",
                "email": "gaurav.kumar@example.com",
                "contact": "9999999999"
            },
            "notes": {
                "address": "Razorpay Corporate Office"
            },
            "theme": {
                "color": "#3399cc"
            }
        }
        var rzp1 = new Razorpay(options);
        rzp1.open()
    }

    function verifyPayment(payment, order) {

    }
</script>

<script>
    function copyContent() {
        var username = document.getElementById('username').innerText;
        var password = document.getElementById('password').innerText;
        var access = document.getElementById('access').innerText;

        var contentToCopy = "Username: " + username + "\nPassword: " + password + "\nAccess Key: " + access;

        // Create a textarea element to hold the content temporarily
        var textarea = document.createElement('textarea');
        textarea.value = contentToCopy;
        document.body.appendChild(textarea);

        // Select and copy the content
        textarea.select();
        document.execCommand('copy');

        // Remove the textarea
        document.body.removeChild(textarea);

        alert('Content copied to clipboard');
    }

    function reloadPage() {
        location.reload();
    }
</script>

<script>
    function toggleVisibility() {
        var container = document.querySelector('.visible');
        container.classList.toggle('visible2');
    }
</script>